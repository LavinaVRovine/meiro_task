{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.0", "generated_at": "2024-05-19T15:21:08.898066Z", "invocation_id": "a3275811-a005-48e8-a7ae-566d2c2e73db", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-19T15:21:08.669986Z", "completed_at": "2024-05-19T15:21:08.679996Z"}, {"name": "execute", "started_at": "2024-05-19T15:21:08.681008Z", "completed_at": "2024-05-19T15:21:08.681008Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.012038707733154297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "analysis.meiro_dbt.q1", "compiled": true, "compiled_code": "SELECT user_name, sum(price) spent\r\n\r\n\r\nFROM ref('full_denom') WHERE extract(isodow from created_ts) = 5\r\ngroup by user_name\r\norder by spent desc\r\nlimit 1", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-19T15:21:08.684988Z", "completed_at": "2024-05-19T15:21:08.687977Z"}, {"name": "execute", "started_at": "2024-05-19T15:21:08.688970Z", "completed_at": "2024-05-19T15:21:08.688970Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005968332290649414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "analysis.meiro_dbt.q2", "compiled": true, "compiled_code": "WITH product_counts AS (\r\n    SELECT\r\n        user_city,\r\n        product_name,\r\n        COUNT(*) as product_count\r\n    FROM\r\n        ref('raw', 'full_denom')\r\n    GROUP BY\r\n        user_city,\r\n        product_name\r\n),\r\nranked_products AS (\r\n    SELECT\r\n        user_city,\r\n        product_name,\r\n        product_count,\r\n        ROW_NUMBER() OVER(PARTITION BY user_city ORDER BY product_count DESC) as product_rank\r\n    FROM\r\n        product_counts\r\n)\r\nSELECT\r\n    user_city,\r\n    product_name,\r\n    product_count\r\nFROM\r\n    ranked_products\r\nWHERE\r\n    product_rank <= 3\r\norder by 1, 2, 3 desc", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-19T15:21:08.693969Z", "completed_at": "2024-05-19T15:21:08.700027Z"}, {"name": "execute", "started_at": "2024-05-19T15:21:08.700971Z", "completed_at": "2024-05-19T15:21:08.700971Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008998870849609375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.meiro_dbt.product_order", "compiled": true, "compiled_code": "SELECT\n    r.id as order_id,\n       r.\"user\"->> 'id' as user_id ,\n       to_timestamp(r.created) as created_ts,\n       expanded_products.id as product_id\nFROM\n    \"meiro\".\"public\".\"raw\" r,\n  json_to_recordset(r.products) AS expanded_products(name varchar, id bigint, price bigint)", "relation_name": "\"meiro\".\"public\".\"product_order\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-19T15:21:08.705970Z", "completed_at": "2024-05-19T15:21:08.710970Z"}, {"name": "execute", "started_at": "2024-05-19T15:21:08.711974Z", "completed_at": "2024-05-19T15:21:08.711974Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009000778198242188, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.meiro_dbt.products", "compiled": true, "compiled_code": "SELECT\n    expanded_products.*\nFROM\n    \"meiro\".\"public\".\"raw\" r,\n  json_to_recordset(r.products) AS expanded_products(name varchar, id bigint, price bigint)\ngroup by expanded_products.name, expanded_products.id, expanded_products.price", "relation_name": "\"meiro\".\"public\".\"products\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-19T15:21:08.717969Z", "completed_at": "2024-05-19T15:21:08.722970Z"}, {"name": "execute", "started_at": "2024-05-19T15:21:08.723970Z", "completed_at": "2024-05-19T15:21:08.723970Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.007972478866577148, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.meiro_dbt.users", "compiled": true, "compiled_code": "with expanded as (\n    select\n       r.\"user\"->> 'id' as id,\n       r.\"user\"->> 'name' as name ,\n       r.\"user\"->> 'city' as city\nfrom \"meiro\".\"public\".\"raw\" r\n)\n\nselect id, name, city from expanded r group by id, name, city", "relation_name": "\"meiro\".\"public\".\"users\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-19T15:21:08.728976Z", "completed_at": "2024-05-19T15:21:08.750969Z"}, {"name": "execute", "started_at": "2024-05-19T15:21:08.751969Z", "completed_at": "2024-05-19T15:21:08.751969Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.024997949600219727, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.meiro_dbt.source_not_null_raw_raw_created.dc51ad84d7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect created\nfrom \"meiro\".\"public\".\"raw\"\nwhere created is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-19T15:21:08.756970Z", "completed_at": "2024-05-19T15:21:08.765483Z"}, {"name": "execute", "started_at": "2024-05-19T15:21:08.766481Z", "completed_at": "2024-05-19T15:21:08.766481Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01251220703125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.meiro_dbt.source_not_null_raw_raw_id.53b403f7cf", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom \"meiro\".\"public\".\"raw\"\nwhere id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-19T15:21:08.771000Z", "completed_at": "2024-05-19T15:21:08.782517Z"}, {"name": "execute", "started_at": "2024-05-19T15:21:08.784523Z", "completed_at": "2024-05-19T15:21:08.784523Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015516519546508789, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.meiro_dbt.source_unique_raw_raw_id.c69cb8f1c2", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    id as unique_field,\n    count(*) as n_records\n\nfrom \"meiro\".\"public\".\"raw\"\nwhere id is not null\ngroup by id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-19T15:21:08.788517Z", "completed_at": "2024-05-19T15:21:08.802033Z"}, {"name": "execute", "started_at": "2024-05-19T15:21:08.803032Z", "completed_at": "2024-05-19T15:21:08.803032Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.016515731811523438, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.meiro_dbt.dbt_utils_accepted_range_products_price__False__0.5c0053df9e", "compiled": true, "compiled_code": "\n\nwith meet_condition as(\n  select *\n  from \"meiro\".\"public\".\"products\"\n),\n\nvalidation_errors as (\n  select *\n  from meet_condition\n  where\n    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds\n    1 = 2\n    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.\n    or not price > 0\n)\n\nselect *\nfrom validation_errors\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-19T15:21:08.807031Z", "completed_at": "2024-05-19T15:21:08.814032Z"}, {"name": "execute", "started_at": "2024-05-19T15:21:08.815032Z", "completed_at": "2024-05-19T15:21:08.815032Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010000467300415039, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.meiro_dbt.not_null_products_id.dea2ae6732", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom \"meiro\".\"public\".\"products\"\nwhere id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-19T15:21:08.820034Z", "completed_at": "2024-05-19T15:21:08.826032Z"}, {"name": "execute", "started_at": "2024-05-19T15:21:08.827032Z", "completed_at": "2024-05-19T15:21:08.827032Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010000467300415039, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.meiro_dbt.not_null_products_price.3b5b0a69be", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect price\nfrom \"meiro\".\"public\".\"products\"\nwhere price is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-19T15:21:08.836033Z", "completed_at": "2024-05-19T15:21:08.850033Z"}, {"name": "execute", "started_at": "2024-05-19T15:21:08.851033Z", "completed_at": "2024-05-19T15:21:08.851033Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.018000364303588867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.meiro_dbt.unique_products_id.100e0f5804", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    id as unique_field,\n    count(*) as n_records\n\nfrom \"meiro\".\"public\".\"products\"\nwhere id is not null\ngroup by id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-19T15:21:08.857032Z", "completed_at": "2024-05-19T15:21:08.866032Z"}, {"name": "execute", "started_at": "2024-05-19T15:21:08.867033Z", "completed_at": "2024-05-19T15:21:08.867033Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.012001276016235352, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.meiro_dbt.full_denom", "compiled": true, "compiled_code": "\n\n\nselect po.order_id, po.user_id, po.created_ts, po.product_id,  p.name as product_name, p.price,\n       u.name as user_name, u.city as user_city\nfrom \"meiro\".\"public\".\"product_order\" po\n    join \"meiro\".\"public\".\"products\" p on po.product_id = p.id\nleft join \"meiro\".\"public\".\"users\" u on po.user_id = u.id", "relation_name": "\"meiro\".\"public\".\"full_denom\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-19T15:21:08.873035Z", "completed_at": "2024-05-19T15:21:08.881032Z"}, {"name": "execute", "started_at": "2024-05-19T15:21:08.882034Z", "completed_at": "2024-05-19T15:21:08.882034Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0110015869140625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.meiro_dbt.not_null_users_id.4db5ed5c63", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom \"meiro\".\"public\".\"users\"\nwhere id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-19T15:21:08.886032Z", "completed_at": "2024-05-19T15:21:08.892547Z"}, {"name": "execute", "started_at": "2024-05-19T15:21:08.893548Z", "completed_at": "2024-05-19T15:21:08.893548Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008517265319824219, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.meiro_dbt.unique_users_id.ec952d9777", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    id as unique_field,\n    count(*) as n_records\n\nfrom \"meiro\".\"public\".\"users\"\nwhere id is not null\ngroup by id\nhaving count(*) > 1\n\n\n", "relation_name": null}], "elapsed_time": 0.5025324821472168, "args": {"source_freshness_run_project_hooks": false, "use_colors_file": true, "log_format": "default", "partial_parse": true, "write_json": true, "empty": false, "which": "compile", "use_colors": true, "profiles_dir": "C:\\Users\\Darth\\PycharmProjects\\meiro_task\\meiro_dbt", "static_parser": true, "enable_legacy_logger": false, "macro_debugging": false, "favor_state": false, "log_path": "C:\\Users\\Darth\\PycharmProjects\\meiro_task\\meiro_dbt\\logs", "defer": false, "exclude": [], "log_level": "info", "cache_selected_only": false, "print": true, "project_dir": "C:\\Users\\Darth\\PycharmProjects\\meiro_task\\meiro_dbt", "printer_width": 80, "warn_error_options": {"include": [], "exclude": []}, "invocation_command": "dbt compile", "require_resource_names_without_spaces": false, "populate_cache": true, "show_resource_report": false, "strict_mode": false, "introspect": true, "send_anonymous_usage_stats": true, "indirect_selection": "eager", "inject_ephemeral_ctes": true, "log_format_file": "debug", "output": "text", "require_explicit_package_overrides_for_builtin_materializations": true, "select": [], "quiet": false, "vars": {}, "log_level_file": "debug", "log_file_max_bytes": 10485760, "version_check": true, "partial_parse_file_diff": true}}