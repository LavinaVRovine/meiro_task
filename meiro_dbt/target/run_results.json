{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.0", "generated_at": "2024-05-19T15:17:09.829178Z", "invocation_id": "17637e99-8337-4ff2-92a1-13b0462dce7b", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-19T15:17:09.630438Z", "completed_at": "2024-05-19T15:17:09.639437Z"}, {"name": "execute", "started_at": "2024-05-19T15:17:09.641443Z", "completed_at": "2024-05-19T15:17:09.641443Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.013006925582885742, "adapter_response": {}, "message": null, "failures": null, "unique_id": "analysis.meiro_dbt.q1", "compiled": true, "compiled_code": "SELECT user_name, sum(price) spent\r\n\r\n\r\nFROM ref('full_denom') WHERE extract(isodow from created_ts) = 5\r\ngroup by user_name\r\norder by spent desc\r\nlimit 1", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-19T15:17:09.645437Z", "completed_at": "2024-05-19T15:17:09.648436Z"}, {"name": "execute", "started_at": "2024-05-19T15:17:09.649435Z", "completed_at": "2024-05-19T15:17:09.649435Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005997419357299805, "adapter_response": {}, "message": null, "failures": null, "unique_id": "analysis.meiro_dbt.q2", "compiled": true, "compiled_code": "WITH product_counts AS (\r\n    SELECT\r\n        user_city,\r\n        product_name,\r\n        COUNT(*) as product_count\r\n    FROM\r\n        ref('raw', 'full_denom')\r\n    GROUP BY\r\n        user_city,\r\n        product_name\r\n),\r\nranked_products AS (\r\n    SELECT\r\n        user_city,\r\n        product_name,\r\n        product_count,\r\n        ROW_NUMBER() OVER(PARTITION BY user_city ORDER BY product_count DESC) as product_rank\r\n    FROM\r\n        product_counts\r\n)\r\nSELECT\r\n    user_city,\r\n    product_name,\r\n    product_count\r\nFROM\r\n    ranked_products\r\nWHERE\r\n    product_rank <= 3\r\norder by 1, 2, 3 desc", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-19T15:17:09.653437Z", "completed_at": "2024-05-19T15:17:09.658961Z"}, {"name": "execute", "started_at": "2024-05-19T15:17:09.659962Z", "completed_at": "2024-05-19T15:17:09.659962Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.007508993148803711, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.meiro_dbt.product_order", "compiled": true, "compiled_code": "SELECT\n    r.id as order_id,\n       r.\"user\"->> 'id' as user_id ,\n       to_timestamp(r.created) as created_ts,\n       expanded_products.id as product_id\nFROM\n    \"meiro\".\"public\".\"raw\" r,\n  json_to_recordset(r.products) AS expanded_products(name varchar, id bigint, price bigint)", "relation_name": "\"meiro\".\"public\".\"product_order\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-19T15:17:09.666965Z", "completed_at": "2024-05-19T15:17:09.672962Z"}, {"name": "execute", "started_at": "2024-05-19T15:17:09.673961Z", "completed_at": "2024-05-19T15:17:09.673961Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008997440338134766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.meiro_dbt.products", "compiled": true, "compiled_code": "SELECT\n    expanded_products.*\nFROM\n    \"meiro\".\"public\".\"raw\" r,\n  json_to_recordset(r.products) AS expanded_products(name varchar, id bigint, price bigint)\ngroup by expanded_products.name, expanded_products.id, expanded_products.price", "relation_name": "\"meiro\".\"public\".\"products\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-19T15:17:09.677558Z", "completed_at": "2024-05-19T15:17:09.683537Z"}, {"name": "execute", "started_at": "2024-05-19T15:17:09.684537Z", "completed_at": "2024-05-19T15:17:09.684537Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008575201034545898, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.meiro_dbt.users", "compiled": true, "compiled_code": "with expanded as (\n    select\n       r.\"user\"->> 'id' as id,\n       r.\"user\"->> 'name' as name ,\n       r.\"user\"->> 'city' as city\nfrom \"meiro\".\"public\".\"raw\" r\n)\n\nselect id, name, city from expanded r group by id, name, city", "relation_name": "\"meiro\".\"public\".\"users\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-19T15:17:09.689538Z", "completed_at": "2024-05-19T15:17:09.707051Z"}, {"name": "execute", "started_at": "2024-05-19T15:17:09.708052Z", "completed_at": "2024-05-19T15:17:09.708052Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.020514488220214844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.meiro_dbt.source_not_null_raw_raw_created.dc51ad84d7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect created\nfrom \"meiro\".\"public\".\"raw\"\nwhere created is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-19T15:17:09.712053Z", "completed_at": "2024-05-19T15:17:09.718053Z"}, {"name": "execute", "started_at": "2024-05-19T15:17:09.719054Z", "completed_at": "2024-05-19T15:17:09.719054Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008987188339233398, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.meiro_dbt.source_not_null_raw_raw_id.53b403f7cf", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom \"meiro\".\"public\".\"raw\"\nwhere id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-19T15:17:09.723051Z", "completed_at": "2024-05-19T15:17:09.732052Z"}, {"name": "execute", "started_at": "2024-05-19T15:17:09.733059Z", "completed_at": "2024-05-19T15:17:09.733059Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010999441146850586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.meiro_dbt.source_unique_raw_raw_id.c69cb8f1c2", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    id as unique_field,\n    count(*) as n_records\n\nfrom \"meiro\".\"public\".\"raw\"\nwhere id is not null\ngroup by id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-19T15:17:09.737065Z", "completed_at": "2024-05-19T15:17:09.748051Z"}, {"name": "execute", "started_at": "2024-05-19T15:17:09.749053Z", "completed_at": "2024-05-19T15:17:09.749053Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.014000892639160156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.meiro_dbt.dbt_utils_accepted_range_products_price__False__0.5c0053df9e", "compiled": true, "compiled_code": "\n\nwith meet_condition as(\n  select *\n  from \"meiro\".\"public\".\"products\"\n),\n\nvalidation_errors as (\n  select *\n  from meet_condition\n  where\n    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds\n    1 = 2\n    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.\n    or not price > 0\n)\n\nselect *\nfrom validation_errors\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-19T15:17:09.753053Z", "completed_at": "2024-05-19T15:17:09.761072Z"}, {"name": "execute", "started_at": "2024-05-19T15:17:09.762053Z", "completed_at": "2024-05-19T15:17:09.762053Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010999441146850586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.meiro_dbt.not_null_products_id.dea2ae6732", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom \"meiro\".\"public\".\"products\"\nwhere id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-19T15:17:09.766581Z", "completed_at": "2024-05-19T15:17:09.772567Z"}, {"name": "execute", "started_at": "2024-05-19T15:17:09.773567Z", "completed_at": "2024-05-19T15:17:09.773567Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009513378143310547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.meiro_dbt.not_null_products_price.3b5b0a69be", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect price\nfrom \"meiro\".\"public\".\"products\"\nwhere price is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-19T15:17:09.777622Z", "completed_at": "2024-05-19T15:17:09.783629Z"}, {"name": "execute", "started_at": "2024-05-19T15:17:09.784623Z", "completed_at": "2024-05-19T15:17:09.784623Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00804758071899414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.meiro_dbt.unique_products_id.100e0f5804", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    id as unique_field,\n    count(*) as n_records\n\nfrom \"meiro\".\"public\".\"products\"\nwhere id is not null\ngroup by id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-19T15:17:09.788636Z", "completed_at": "2024-05-19T15:17:09.792619Z"}, {"name": "execute", "started_at": "2024-05-19T15:17:09.793634Z", "completed_at": "2024-05-19T15:17:09.793634Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.007013797760009766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.meiro_dbt.full_denom", "compiled": true, "compiled_code": "\n\n\nselect po.order_id, po.user_id, po.created_ts, po.product_id,  p.name as product_name, p.price,\n       u.name as user_name, u.city as user_city\nfrom \"meiro\".\"public\".\"product_order\" po\n    join \"meiro\".\"public\".\"products\" p on po.product_id = p.id\nleft join \"meiro\".\"public\".\"users\" u on po.user_id = u.id", "relation_name": "\"meiro\".\"public\".\"full_denom\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-19T15:17:09.797621Z", "completed_at": "2024-05-19T15:17:09.804619Z"}, {"name": "execute", "started_at": "2024-05-19T15:17:09.805622Z", "completed_at": "2024-05-19T15:17:09.805622Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009999752044677734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.meiro_dbt.not_null_users_id.4db5ed5c63", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom \"meiro\".\"public\".\"users\"\nwhere id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-19T15:17:09.810136Z", "completed_at": "2024-05-19T15:17:09.816135Z"}, {"name": "execute", "started_at": "2024-05-19T15:17:09.817135Z", "completed_at": "2024-05-19T15:17:09.817135Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008996963500976562, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.meiro_dbt.unique_users_id.ec952d9777", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    id as unique_field,\n    count(*) as n_records\n\nfrom \"meiro\".\"public\".\"users\"\nwhere id is not null\ngroup by id\nhaving count(*) > 1\n\n\n", "relation_name": null}], "elapsed_time": 0.5066730976104736, "args": {"populate_cache": true, "static": false, "enable_legacy_logger": false, "select": [], "which": "generate", "exclude": [], "printer_width": 80, "partial_parse_file_diff": true, "warn_error_options": {"include": [], "exclude": []}, "indirect_selection": "eager", "strict_mode": false, "cache_selected_only": false, "log_file_max_bytes": 10485760, "introspect": true, "log_level_file": "debug", "compile": true, "source_freshness_run_project_hooks": false, "use_colors": true, "write_json": true, "defer": false, "profiles_dir": "C:\\Users\\Darth\\PycharmProjects\\meiro_task\\meiro_dbt", "require_explicit_package_overrides_for_builtin_materializations": true, "macro_debugging": false, "log_path": "C:\\Users\\Darth\\PycharmProjects\\meiro_task\\meiro_dbt\\logs", "partial_parse": true, "favor_state": false, "require_resource_names_without_spaces": false, "vars": {}, "log_format_file": "debug", "print": true, "log_format": "default", "send_anonymous_usage_stats": true, "static_parser": true, "quiet": false, "log_level": "info", "empty_catalog": false, "show_resource_report": false, "invocation_command": "dbt docs generate", "use_colors_file": true, "project_dir": "C:\\Users\\Darth\\PycharmProjects\\meiro_task\\meiro_dbt", "version_check": true}}