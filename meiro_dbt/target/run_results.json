{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.0", "generated_at": "2024-05-19T14:59:59.787465Z", "invocation_id": "e4dc62c1-a39e-431d-88c9-b5b189101ece", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-19T14:59:59.588925Z", "completed_at": "2024-05-19T14:59:59.600921Z"}, {"name": "execute", "started_at": "2024-05-19T14:59:59.601922Z", "completed_at": "2024-05-19T14:59:59.601922Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01699972152709961, "adapter_response": {}, "message": null, "failures": null, "unique_id": "analysis.meiro_dbt.q1", "compiled": true, "compiled_code": "SELECT user_name, sum(price) spent\r\n\r\n\r\nFROM ref('full_denom') WHERE extract(isodow from created_ts) = 5\r\ngroup by user_name\r\norder by spent desc\r\nlimit 1", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-19T14:59:59.605937Z", "completed_at": "2024-05-19T14:59:59.609922Z"}, {"name": "execute", "started_at": "2024-05-19T14:59:59.610923Z", "completed_at": "2024-05-19T14:59:59.610923Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.007000923156738281, "adapter_response": {}, "message": null, "failures": null, "unique_id": "analysis.meiro_dbt.q2", "compiled": true, "compiled_code": "WITH product_counts AS (\r\n    SELECT\r\n        user_city,\r\n        product_name,\r\n        COUNT(*) as product_count\r\n    FROM\r\n        ref('raw', 'full_denom')\r\n    GROUP BY\r\n        user_city,\r\n        product_name\r\n),\r\nranked_products AS (\r\n    SELECT\r\n        user_city,\r\n        product_name,\r\n        product_count,\r\n        ROW_NUMBER() OVER(PARTITION BY user_city ORDER BY product_count DESC) as product_rank\r\n    FROM\r\n        product_counts\r\n)\r\nSELECT\r\n    user_city,\r\n    product_name,\r\n    product_count\r\nFROM\r\n    ranked_products\r\nWHERE\r\n    product_rank <= 3\r\norder by 1, 2, 3 desc", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-19T14:59:59.616979Z", "completed_at": "2024-05-19T14:59:59.624926Z"}, {"name": "execute", "started_at": "2024-05-19T14:59:59.625923Z", "completed_at": "2024-05-19T14:59:59.625923Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011992931365966797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.meiro_dbt.product_order", "compiled": true, "compiled_code": "SELECT\n    r.id as order_id,\n       r.\"user\"->> 'id' as user_id ,\n       to_timestamp(r.created) as created_ts,\n       expanded_products.id as product_id\nFROM\n    \"meiro\".\"public\".\"raw\" r,\n  json_to_recordset(r.products) AS expanded_products(name varchar, id bigint, price bigint)", "relation_name": "\"meiro\".\"public\".\"product_order\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-19T14:59:59.633923Z", "completed_at": "2024-05-19T14:59:59.638923Z"}, {"name": "execute", "started_at": "2024-05-19T14:59:59.639921Z", "completed_at": "2024-05-19T14:59:59.639921Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008000612258911133, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.meiro_dbt.products", "compiled": true, "compiled_code": "SELECT\n    expanded_products.*\nFROM\n    \"meiro\".\"public\".\"raw\" r,\n  json_to_recordset(r.products) AS expanded_products(name varchar, id bigint, price bigint)\ngroup by expanded_products.name, expanded_products.id, expanded_products.price", "relation_name": "\"meiro\".\"public\".\"products\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-19T14:59:59.643921Z", "completed_at": "2024-05-19T14:59:59.650921Z"}, {"name": "execute", "started_at": "2024-05-19T14:59:59.651921Z", "completed_at": "2024-05-19T14:59:59.651921Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00999903678894043, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.meiro_dbt.users", "compiled": true, "compiled_code": "with expanded as (\n    select\n       r.\"user\"->> 'id' as id,\n       r.\"user\"->> 'name' as name ,\n       r.\"user\"->> 'city' as city\nfrom \"meiro\".\"public\".\"raw\" r\n)\n\nselect id, name, city from expanded r group by id, name, city", "relation_name": "\"meiro\".\"public\".\"users\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-19T14:59:59.655925Z", "completed_at": "2024-05-19T14:59:59.673431Z"}, {"name": "execute", "started_at": "2024-05-19T14:59:59.674432Z", "completed_at": "2024-05-19T14:59:59.674432Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02050924301147461, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.meiro_dbt.source_not_null_raw_raw_created.dc51ad84d7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect created\nfrom \"meiro\".\"public\".\"raw\"\nwhere created is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-19T14:59:59.678976Z", "completed_at": "2024-05-19T14:59:59.684953Z"}, {"name": "execute", "started_at": "2024-05-19T14:59:59.685965Z", "completed_at": "2024-05-19T14:59:59.685965Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009522438049316406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.meiro_dbt.source_not_null_raw_raw_id.53b403f7cf", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom \"meiro\".\"public\".\"raw\"\nwhere id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-19T14:59:59.689955Z", "completed_at": "2024-05-19T14:59:59.698954Z"}, {"name": "execute", "started_at": "2024-05-19T14:59:59.699955Z", "completed_at": "2024-05-19T14:59:59.699955Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0110015869140625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.meiro_dbt.source_unique_raw_raw_id.c69cb8f1c2", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    id as unique_field,\n    count(*) as n_records\n\nfrom \"meiro\".\"public\".\"raw\"\nwhere id is not null\ngroup by id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-19T14:59:59.703955Z", "completed_at": "2024-05-19T14:59:59.715953Z"}, {"name": "execute", "started_at": "2024-05-19T14:59:59.716960Z", "completed_at": "2024-05-19T14:59:59.716960Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01500558853149414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.meiro_dbt.dbt_utils_accepted_range_products_price__False__0.5c0053df9e", "compiled": true, "compiled_code": "\n\nwith meet_condition as(\n  select *\n  from \"meiro\".\"public\".\"products\"\n),\n\nvalidation_errors as (\n  select *\n  from meet_condition\n  where\n    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds\n    1 = 2\n    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.\n    or not price > 0\n)\n\nselect *\nfrom validation_errors\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-19T14:59:59.720958Z", "completed_at": "2024-05-19T14:59:59.727968Z"}, {"name": "execute", "started_at": "2024-05-19T14:59:59.728954Z", "completed_at": "2024-05-19T14:59:59.728954Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00999903678894043, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.meiro_dbt.not_null_products_id.dea2ae6732", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom \"meiro\".\"public\".\"products\"\nwhere id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-19T14:59:59.732954Z", "completed_at": "2024-05-19T14:59:59.738953Z"}, {"name": "execute", "started_at": "2024-05-19T14:59:59.739963Z", "completed_at": "2024-05-19T14:59:59.739963Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00900888442993164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.meiro_dbt.not_null_products_price.3b5b0a69be", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect price\nfrom \"meiro\".\"public\".\"products\"\nwhere price is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-19T14:59:59.743972Z", "completed_at": "2024-05-19T14:59:59.749464Z"}, {"name": "execute", "started_at": "2024-05-19T14:59:59.750463Z", "completed_at": "2024-05-19T14:59:59.750463Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008509397506713867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.meiro_dbt.unique_products_id.100e0f5804", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    id as unique_field,\n    count(*) as n_records\n\nfrom \"meiro\".\"public\".\"products\"\nwhere id is not null\ngroup by id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-19T14:59:59.754464Z", "completed_at": "2024-05-19T14:59:59.760464Z"}, {"name": "execute", "started_at": "2024-05-19T14:59:59.760464Z", "completed_at": "2024-05-19T14:59:59.760464Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00800013542175293, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.meiro_dbt.full_denom", "compiled": true, "compiled_code": "\n\n\nselect po.order_id, po.user_id, po.created_ts, po.product_id,  p.name as product_name, p.price,\n       u.name as user_name, u.city as user_city\nfrom \"meiro\".\"public\".\"product_order\" po\n    join \"meiro\".\"public\".\"products\" p on po.product_id = p.id\nleft join \"meiro\".\"public\".\"users\" u on po.user_id = u.id", "relation_name": "\"meiro\".\"public\".\"full_denom\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-19T14:59:59.764465Z", "completed_at": "2024-05-19T14:59:59.769465Z"}, {"name": "execute", "started_at": "2024-05-19T14:59:59.770465Z", "completed_at": "2024-05-19T14:59:59.770465Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008001565933227539, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.meiro_dbt.not_null_users_id.4db5ed5c63", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom \"meiro\".\"public\".\"users\"\nwhere id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-19T14:59:59.774464Z", "completed_at": "2024-05-19T14:59:59.782464Z"}, {"name": "execute", "started_at": "2024-05-19T14:59:59.783465Z", "completed_at": "2024-05-19T14:59:59.783465Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011000871658325195, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.meiro_dbt.unique_users_id.ec952d9777", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    id as unique_field,\n    count(*) as n_records\n\nfrom \"meiro\".\"public\".\"users\"\nwhere id is not null\ngroup by id\nhaving count(*) > 1\n\n\n", "relation_name": null}], "elapsed_time": 0.4745066165924072, "args": {"print": true, "log_format": "default", "empty_catalog": false, "partial_parse": true, "require_resource_names_without_spaces": false, "log_format_file": "debug", "select": [], "write_json": true, "vars": {}, "cache_selected_only": false, "macro_debugging": false, "indirect_selection": "eager", "log_file_max_bytes": 10485760, "which": "generate", "introspect": true, "log_path": "C:\\Users\\Darth\\PycharmProjects\\meiro_task\\meiro_dbt\\logs", "compile": true, "defer": false, "invocation_command": "dbt docs generate", "version_check": true, "static_parser": true, "enable_legacy_logger": false, "printer_width": 80, "project_dir": "C:\\Users\\Darth\\PycharmProjects\\meiro_task\\meiro_dbt", "use_colors_file": true, "populate_cache": true, "source_freshness_run_project_hooks": false, "profiles_dir": "C:\\Users\\Darth\\PycharmProjects\\meiro_task\\meiro_dbt", "strict_mode": false, "show_resource_report": false, "send_anonymous_usage_stats": true, "log_level_file": "debug", "quiet": false, "use_colors": true, "exclude": [], "favor_state": false, "partial_parse_file_diff": true, "log_level": "info", "static": false, "require_explicit_package_overrides_for_builtin_materializations": true, "warn_error_options": {"include": [], "exclude": []}}}